---
permalink: protect-sco/task_restore_and_recovere_tablespaces_using_point_in_time_recovery.html 
sidebar: sidebar 
keywords: restore, PITR, point-in-time recovery, RMAN, tablespaces 
summary: '您可以恢复已损坏或删除的表空间子集，而不会影响数据库中的其他表空间。  SnapCenter使用 RMAN 执行表空间的时间点恢复 (PITR)。' 
---
= 使用时间点恢复来还原和恢复表空间
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以恢复已损坏或删除的表空间子集，而不会影响数据库中的其他表空间。  SnapCenter使用 RMAN 执行表空间的时间点恢复 (PITR)。

*开始之前*

* 执行表空间 PITR 所需的备份应该被编目和挂载。
* 如果您以非 root 用户身份安装了该插件，则应手动为 prescript 和 postscript 目录分配执行权限。


*关于此任务*

在 PITR 操作期间，RMAN 在指定的辅助目的地创建一个辅助实例。辅助目标可以是挂载点或 ASM 磁盘组。如果挂载位置有足够的空间，则可以重复使用其中一个挂载位置，而不是专用挂载点。

您应该指定日期和时间或 SCN，并在源数据库上恢复表空间。

您可以选择并恢复驻留在 ASM、NFS 和 SAN 环境中的多个表空间。例如，如果表空间 TS2 和 TS3 位于 NFS 上，而 TS4 位于 SAN 上，则可以执行单个 PITR 操作来恢复所有表空间。


NOTE: 在 RAC 设置中，您可以从 RAC 的任何节点执行表空间的 PITR。

*步骤*

. 在左侧导航窗格中，单击“*资源*”，然后从列表中选择适当的插件。
. 在资源页面中，从*视图*列表中选择*数据库*或*资源组*。
. 从数据库详细信息视图或资源组详细信息视图中选择单实例（多租户）类型的数据库。
+
进入数据库拓扑页面。

. 从“管理副本”视图中，从主存储系统或辅助（镜像或复制）存储系统中选择“*备份*”。
+
如果备份未编入目录，您应该选择该备份并单击*目录*。

. 选择已编目的备份，然后单击 *image:../media/restore_icon.gif["恢复图标"] *.
. 在“还原范围”页面中，执行以下任务：
+
.. 如果您选择了 Real Application Clusters (RAC) 环境中的数据库备份，请选择 RAC 节点。
.. 选择*表空间*，然后指定要恢复的表空间。
+

NOTE: 您不能在 SYSAUX、SYSTEM 和 UNDO 表空间上执行 PITR。

.. 选择*如果需要还原和恢复则更改数据库状态*将数据库的状态更改为执行还原和恢复操作所需的状态。


. 在“恢复范围”页面中，执行以下操作之一：
+
** 如果要恢复到特定的系统变更号 (SCN)，请选择 *直到 SCN* 并指定 SCN 和辅助目标。
** 如果要恢复到特定的日期和时间，请选择*日期和时间*并指定日期和时间以及辅助目的地。
+
SnapCenter根据指定的 SCN 或选定的日期和时间识别、装载和编录执行 PITR 所需的最佳数量的数据和日志备份。



. 在 PreOps 页面中，输入要在恢复操作之前运行的处方的路径和参数。
+
您应该将处方存储在 /var/opt/snapcenter/spl/scripts 路径中或此路径内的任何文件夹中。默认情况下，填充 /var/opt/snapcenter/spl/scripts 路径。如果您在此路径内创建了任何文件夹来存储脚本，则必须在路径中指定这些文件夹。

+
您还可以指定脚本超时值。默认值是 60 秒。

+
SnapCenter允许您在执行前脚本和后脚本时使用预定义的环境变量。link:../protect-sco/predefined-environment-variables-prescript-postscript-restore.html["了解更多"^]

. 在 PostOps 页面中，执行以下步骤：
+
.. 输入要在恢复操作后运行的后记的路径和参数。
+

NOTE: 如果恢复操作失败，则不会执行后记，而是直接触发清理活动。

.. 如果要在恢复后打开数据库，请选中该复选框。


. 在通知页面中，从*电子邮件首选项*下拉列表中，选择您想要发送电子邮件通知的场景。
. 查看摘要，然后单击“*完成*”。
. 通过单击“*监视*”>“*作业*”来监视操作进度。

